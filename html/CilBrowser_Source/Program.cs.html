<html><head><title>Source file: Program.cs</title><style>.memberid { color: rgb(43, 145, 175); text-decoration: none; }</style></head>
<body><p>.NET CIL Browser&nbsp;-&nbsp;<a href="index.html">Back to table of contents</a></p>
<h2>Source file: Program.cs</h2><table width="100%" cellpadding="5" cellspacing="5"><tr><td width="200" valign="top" style="border: thin solid;"><p>Files in CilBrowser directory:</p><p><a href="CilBrowser.csproj.html">CilBrowser.csproj</a></p><p><a href="generate-demo.cmd.html">generate-demo.cmd</a></p><p><b>Program.cs</b></p><p><a href="run.cmd.html">run.cmd</a></p></td>
<td valign="top"><pre style="white-space: pre-wrap;"><code><span style="color: green;">/* CIL Browser (https://github.com/MSDN-WhiteKnight/CilBrowser)
 * Copyright (c) 2022,  MSDN.WhiteKnight 
 * License: BSD 3-Clause */
</span><span style="color: blue;">using </span>System;
<span style="color: blue;">using </span>System.IO;
<span style="color: blue;">using </span>System.Reflection;
<span style="color: blue;">using </span>CilBrowser.Core;
<span style="color: blue;">using </span>CilTools.Metadata;

<span style="color: blue;">namespace </span>CilBrowser
{
    <span style="color: blue;">class </span>Program
    {
        <span style="color: blue;">static </span><span style="color: blue;">bool </span>TryReadExpectedParameter(<span style="color: blue;">string</span>[] args, <span style="color: blue;">int </span>pos, <span style="color: blue;">string </span>expected)
        {
            <span style="color: blue;">if </span>(pos &gt;= args.Length) <span style="color: blue;">return </span><span style="color: blue;">false</span>;

            <span style="color: blue;">if </span>(args[pos] == expected) <span style="color: blue;">return </span><span style="color: blue;">true</span>;
            <span style="color: blue;">else </span><span style="color: blue;">return </span><span style="color: blue;">false</span>;
        }

        <span style="color: blue;">static </span><span style="color: blue;">string </span>ReadCommandParameter(<span style="color: blue;">string</span>[] args, <span style="color: blue;">int </span>pos)
        {
            <span style="color: blue;">if </span>(pos &gt;= args.Length) <span style="color: blue;">return </span><span style="color: blue;">null</span>;

            <span style="color: blue;">return </span>args[pos];
        }

        <span style="color: blue;">static </span><span style="color: blue;">int </span>GenerateDemo()
        {
            AssemblyReader reader = <span style="color: blue;">new </span>AssemblyReader();
            Console.WriteLine(<span style="color: red;">&quot;Generating demo website...&quot;</span>);

            <span style="color: blue;">using </span>(reader)
            {
                Assembly ass = reader.LoadFrom(<span style="color: blue;">typeof</span>(HtmlGenerator).Assembly.Location);
                HtmlGenerator.GenerateWebsite(ass, <span style="color: red;">&quot;./CilBrowser.Core/&quot;</span>);
                ass = reader.LoadFrom(<span style="color: blue;">typeof</span>(Program).Assembly.Location);
                HtmlGenerator.GenerateWebsite(ass, <span style="color: red;">&quot;./CilBrowser/&quot;</span>);
            }

            HtmlGenerator.GenerateWebsite(<span style="color: red;">&quot;../../../../CilBrowser.Core&quot;</span>, <span style="color: red;">&quot;./CilBrowser.Core_Source/&quot;</span>, 0);
            HtmlGenerator.GenerateWebsite(<span style="color: red;">&quot;../../../../CilBrowser&quot;</span>, <span style="color: red;">&quot;./CilBrowser_Source/&quot;</span>, 0);

            Console.WriteLine(<span style="color: red;">&quot;Generated!&quot;</span>);
            <span style="color: blue;">return </span>0;
        }

        <span style="color: blue;">static </span><span style="color: blue;">void </span>Main(<span style="color: blue;">string</span>[] args)
        {
            <span style="color: green;">//parse command line parameters
            </span><span style="color: blue;">string </span>inputPath;
            <span style="color: blue;">string </span>outputPath = <span style="color: blue;">null</span>;

            <span style="color: blue;">if </span>(args.Length == 0)
            {
                GenerateDemo();
                <span style="color: blue;">return</span>;
            }

            <span style="color: blue;">int </span>pos = 0;

            <span style="color: blue;">if </span>(TryReadExpectedParameter(args, pos, <span style="color: red;">&quot;--output&quot;</span>))
            {
                pos++;
                outputPath = ReadCommandParameter(args, pos);
                pos++;
            }

            inputPath = ReadCommandParameter(args, pos);

            <span style="color: blue;">if </span>(<span style="color: blue;">string</span>.IsNullOrEmpty(inputPath))
            {
                GenerateDemo();
                <span style="color: blue;">return</span>;
            }

            <span style="color: blue;">if </span>(<span style="color: blue;">string</span>.IsNullOrEmpty(outputPath))
            {
                outputPath = <span style="color: red;">&quot;./Output/&quot;</span>;
            }

            <span style="color: green;">//generate website
            </span><span style="color: blue;">string </span>ext = Path.GetExtension(inputPath);

            <span style="color: blue;">if </span>(Utils.StrEquals(ext, <span style="color: red;">&quot;.dll&quot;</span>) || Utils.StrEquals(ext, <span style="color: red;">&quot;.exe&quot;</span>) || Utils.StrEquals(ext, <span style="color: red;">&quot;.winmd&quot;</span>))
            {
                AssemblyReader reader = <span style="color: blue;">new </span>AssemblyReader();

                <span style="color: blue;">using </span>(reader)
                {
                    Assembly ass = reader.LoadFrom(inputPath);
                    HtmlGenerator.GenerateWebsite(ass, outputPath);
                }
            }
            <span style="color: blue;">else </span><span style="color: green;">//source directory
            </span>{
                HtmlGenerator.GenerateWebsite(inputPath, outputPath, 0);
            }

            Console.WriteLine(<span style="color: red;">&quot;Generated!&quot;</span>);
        }
    }
}
</code></pre></td></tr></table><p><a href="index.html">Back to table of contents</a></p><hr/><p>Generated by <a href="https://github.com/MSDN-WhiteKnight/CilBrowser">CIL Browser</a></p>
</body></html>